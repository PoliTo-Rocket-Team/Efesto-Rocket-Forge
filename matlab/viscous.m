A3_1 = [

149.63849360675434	0.4355555555555555;
239.63452766809306	0.36444444444444435;
422.3280365615592	0.3288888888888888;
581.1631828380109	0.3288888888888888;
715.1866691363321	0.3111111111111111;
873.1211800402033	0.3111111111111111;
1000	0.3111111111111111;
121.59676203781292	0.45333333333333337;
185.62259902365912	0.3999999999999999;
314.34050505621366	0.3466666666666667;
495.42053442489	0.3288888888888888;
365.8122395374801	0.3288888888888888;
10.080131657511451	1.128888888888889;
14.904253384186886	0.951111111111111;
22.75197302391669	0.808888888888889;
35.57349343716032	0.6666666666666667;
56.51534431091384	0.5777777777777777;
99.60173365120096	0.48888888888888893
];

xdom = linspace(10,1000,1000);

x3_1 = A3_1(:,1);
y3_1 = A3_1(:,2);

a3_1 = 3.2966;
b3_1 = -0.5598;
c3_1 = 0.2268;

hypfit3_1 = @(x) a3_1*x.^(b3_1) + c3_1;

A5_1 = [
    
10.080131657511451	1.7866666666666666;
15.023683636951446	1.5022222222222221;
22.934288354922916	1.2533333333333334;
35.57349343716032	1.057777777777778;
56.51534431091384	0.8977777777777778;
99.60173365120096	0.7555555555555555;
121.59676203781292	0.7022222222222223;
149.63849360675434	0.6666666666666667;
185.62259902365912	0.6133333333333333;
239.63452766809306	0.5955555555555556;
314.34050505621366	0.56;
365.8122395374801	0.56;
422.3280365615592	0.56;
495.42053442489	0.5422222222222222;
581.1631828380109	0.5244444444444445;
715.1866691363321	0.5066666666666666;
873.1211800402033	0.5066666666666666;
1000	0.47111111111111104];

x5_1 = A5_1(:,1);
y5_1 = A5_1(:,2);

a5_1 = 5.6036;
b5_1 = -0.6008;
c5_1 = 0.3961;

pxd = 761.048463461;

hypfit5_1 = @(x) a5_1*x.^(b5_1) + c5_1;

semilogx(xdom,hypfit3_1(xdom),'b','LineWidth',1)
hold on
semilogx(x3_1, y3_1, '.b', 'MarkerSize',10,'HandleVisibility','off')
semilogx(xdom,hypfit5_1(xdom),'r','LineWidth',1)
semilogx(x5_1, y5_1, '.r', 'MarkerSize',10,'HandleVisibility','off')
xline(pxd, '--k','LineWidth',0.5,'HandleVisibility','off')
grid on
grid minor
ylim([0 2])
xlim([10 1000])
ylabel('Viscous-drag performance loss $[\%]$',Interpreter='latex')
xlabel('Chamber pressure $\times$ throat diameter $[psia \times in]$',Interpreter='latex')
legend('$\varepsilon$ = 3','$\varepsilon$ = 5',Interpreter='latex')
title('Digitized curves from NASA SP 8120',Interpreter='latex')

z_f = 1-hypfit3_1(pxd)/100;

mytitleText = ['Viscous-drag losses = ',  num2str(hypfit3_1(pxd)), ' %% \nViscous-drag efficiency = ', num2str(z_f), '\n'];
fprintf(mytitleText)

clear mytitleText pxd A3_1 a3_1 a5_1 A5_1 b3_1 b5_1 c3_1 c5_1 hypfit3_1 hypfit5_1 x3_1 x5_1 xdom y3_1 y5_1